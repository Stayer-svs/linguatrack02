<!-- app_vocab/templates/app_vocab/word_list.html -->
{% extends "app_vocab/base.html" %}

{% block title %}–¢—Ä–µ–Ω–∞–∂–µ—Ä —Å–ª–æ–≤{% endblock %}

{% block extra_css %}
<style>
    .stats-bar {
        background: #f5f5f5;
        padding: 10px;
        border-radius: 5px;
        margin-bottom: 20px;
        text-align: center;
    }
    .stats-bar span {
        margin: 0 10px;
        font-size: 0.9em;
    }
    .controls {
        text-align: center;
        margin-bottom: 20px;
    }
    .reverse-btn {
        padding: 10px 20px;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin: 5px;
    }
    .reverse-btn:hover {
        background-color: #45a049;
    }
    .word-card {
        border: 1px solid #ddd;
        padding: 15px;
        margin: 15px auto;
        border-radius: 8px;
        max-width: 500px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        font-weight: bold;
        font-size: 1.4em;
        text-align: center;
        margin-bottom: 10px;
    }
    .transcription {
        text-align: center;
        font-style: italic;
        color: #666;
        margin-bottom: 10px;
    }
    .answer {
        text-align: center;
        font-size: 1.2em;
        color: #2E7D32;
        margin: 15px 0;
        display: none;
    }
    .action-buttons {
        text-align: center;
    }
    .btn {
        padding: 8px 16px;
        margin: 0 5px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
    }
    .show-btn {
        background-color: #2196F3;
        color: white;
    }
    .know-btn {
        background-color: #4CAF50;
        color: white;
    }
    .dont-know-btn {
        background-color: #f44336;
        color: white;
    }
    .btn:hover {
        opacity: 0.9;
    }
    .progress-info {
        text-align: center;
        font-size: 0.8em;
        color: #999;
        margin-top: 10px;
    }
    .no-words {
        text-align: center;
        padding: 40px;
        color: #666;
    }
    h1 {
        text-align: center;
        color: #333;
        margin-bottom: 20px;
    }
</style>
{% endblock %}

{% block content %}
<h1>üéì –¢—Ä–µ–Ω–∞–∂–µ—Ä —Å–ª–æ–≤ (SRS)</h1>

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
{% if statistics %}
<div class="stats-bar">
    <span>üìä –í—Å–µ–≥–æ —Å–ª–æ–≤: {{ statistics.total_words }}</span>
    <span>üÜï –ù–æ–≤—ã–µ: {{ statistics.new_words }}</span>
    <span>üìö –í –ø—Ä–æ—Ü–µ—Å—Å–µ: {{ statistics.learning_words }}</span>
    <span>‚úÖ –ò–∑—É—á–µ–Ω–æ: {{ statistics.learned_words }}</span>
    <span>üéØ –ù–∞ —Å–µ–≥–æ–¥–Ω—è: {{ statistics.today_words }}</span>
</div>
{% endif %}

<div class="daily-limits" style="background: #e8f5e8; padding: 12px; border-radius: 8px; margin: 15px 0; text-align: center; border: 2px solid #4CAF50;">
    <strong>üìÖ –î–Ω–µ–≤–Ω—ã–µ –ª–∏–º–∏—Ç—ã:</strong>
    <span style="margin: 0 15px;">üîÑ –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–π: <strong>{{ statistics.today_words }}</strong>/{{ statistics.daily_review_limit }}</span>
    <span>üÜï –ù–æ–≤—ã—Ö —Å–ª–æ–≤: <strong>{{ statistics.available_new_words }}</strong>/{{ statistics.daily_new_words }}</span>
</div>

<!-- –ü–æ—Å–ª–µ –±–ª–æ–∫–∞ —Å –ª–∏–º–∏—Ç–∞–º–∏ –ü–æ—è—Å–Ω–µ–Ω–∏—è -->
<div style="background: #e3f2fd; padding: 10px; border-radius: 5px; margin: 10px 0; font-size: 0.9em;text-align: center;">
    üí° –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è.
</div>



<!-- –ë–ª–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Ä–µ–≤–µ—Ä—Å) -->
<div class="controls">
    {% if is_reverse %}
        <a href="?reverse=0"><button class="reverse-btn">–†–µ–∂–∏–º: –ü–ï–†–ï–í–û–î ‚Üí –°–õ–û–í–û</button></a>
        <p><small>(–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–≤–æ–¥, –Ω—É–∂–Ω–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å —Å–ª–æ–≤–æ)</small></p>
    {% else %}
        <a href="?reverse=1"><button class="reverse-btn">–†–µ–∂–∏–º: –°–õ–û–í–û ‚Üí –ü–ï–†–ï–í–û–î</button></a>
        <p><small>(–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª–æ–≤–æ, –Ω—É–∂–Ω–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥)</small></p>
    {% endif %}
</div>

<!-- –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤-–∫–∞—Ä—Ç–æ—á–µ–∫ -->
{% if user_words %}
    {% for user_word in user_words %}
        <div class="word-card">
            <!-- –í–æ–ø—Ä–æ—Å (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∂–∏–º–∞ —Ä–µ–≤–µ—Ä—Å–∞) -->
            <div class="question">
                {% if is_reverse %}
                    {{ user_word.word.translation }}
                {% else %}
                    {{ user_word.word.original }}
                {% endif %}
            </div>

            <!-- –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –≤ –ø—Ä—è–º–æ–º —Ä–µ–∂–∏–º–µ) -->
            {% if not is_reverse and user_word.word.transcription %}
                <div class="transcription">[{{ user_word.word.transcription }}]</div>
            {% endif %}

            <!-- –û—Ç–≤–µ—Ç (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) -->
            <div class="answer" id="answer-{{ user_word.id }}">
                {% if is_reverse %}
                    <strong>{{ user_word.word.original }}</strong>
                    {% if user_word.word.transcription %}
                        <br><em>[{{ user_word.word.transcription }}]</em>
                    {% endif %}
                {% else %}
                    <strong>{{ user_word.word.translation }}</strong>
                {% endif %}
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="action-buttons">
                <!-- –ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥" -->
                <button class="btn show-btn" onclick="showAnswer({{ user_word.id }})">–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</button>


                <!-- –ö–Ω–æ–ø–∫–∏ "–ó–Ω–∞—é"/"–ù–µ –∑–Ω–∞—é" (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç—ã) -->
                <span id="knowledge-buttons-{{ user_word.id }}" style="display: none;">
                    <a href="?word_id={{ user_word.id }}&action=know{% if is_reverse %}&reverse=1{% endif %}">
                        <button class="btn know-btn">–ó–Ω–∞—é ‚úì</button>
                    </a>
                    <a href="?word_id={{ user_word.id }}&action=dont_know{% if is_reverse %}&reverse=1{% endif %}">
                        <button class="btn dont-know-btn">–ù–µ –∑–Ω–∞—é ‚úó</button>
                    </a>
                </span>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ -->
            <div class="progress-info">
                –£—Ä–æ–≤–µ–Ω—å: {{ user_word.get_knowledge_level }} |
                –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–π: {{ user_word.repetition }} |
                –°–ª–µ–¥. –ø–æ–≤—Ç–æ—Ä: {{ user_word.next_review|date:"d.m.Y" }}
            </div>
        </div>
    {% endfor %}
{% else %}
    <div class="no-words">
        <h3>üéâ –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!</h3>
        <p>–ù–∞ —Å–µ–≥–æ–¥–Ω—è –≤—Å–µ —Å–ª–æ–≤–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω—ã.</p>
        <p>–ù–æ–≤—ã–µ —Å–ª–æ–≤–∞ –ø–æ—è–≤—è—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π.</p>
        {% if no_words_message %}
            <p><a href="{% url 'app_vocab:my_words' %}" style="color: #2196F3; text-decoration: none; font-weight: bold;">
        ‚ûï –ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–æ–≤–∞ –∫–Ω–æ–ø–∫–æ–π ¬´–°–µ–π—á–∞—Å¬ª –Ω–∞ –≤–∫–ª–∞–¥–∫–µ ¬´–ú–æ–∏ —Å–ª–æ–≤–∞¬ª
    </a></p>
        {% endif %}
    </div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
    function showAnswer(userWordId) {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–ª–æ–∫ —Å –æ—Ç–≤–µ—Ç–æ–º
        document.getElementById('answer-' + userWordId).style.display = 'block';
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ "–ó–Ω–∞—é"/"–ù–µ –∑–Ω–∞—é"
        document.getElementById('knowledge-buttons-' + userWordId).style.display = 'inline';
        // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç"
        event.target.style.display = 'none';
    }
</script>
{% endblock %}